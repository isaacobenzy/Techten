name: Build debug Apk

on: workflow_dispatch

jobs:
    build:
      runs-on: ubuntu-latest
      steps:
        - name: Checkout repository
          uses: actions/checkout@v2

        - name: Install Java
          uses: actions/setup-java@v2
          with:
            java-version: "20"
            distribution: "adopt"
            cache: "gradle"
        
        - name: Setup Node
          uses: actions/setup-node@v3
          with:
            node-version: "18.19.1"
        
        - name: Install node modules
          run: |
                npm install -g corepack
                yarn install
                
        - name: Cache Gradle Wrapper
          uses: actions/cache@v2
          with:
            path: ~/.gradle/wrapper
            key: ${{ runner.os }}-gradle-wrapper-${{ hashFiles('gradle/wrapper/gradle-wrapper.properties') }}

        - name: Cache Gradle Dependencies
          uses: actions/cache@v2
          with:
            path: ~/.gradle/caches
            key: ${{ runner.os }}-gradle-caches-${{ hashFiles('gradle/wrapper/gradle-wrapper.properties') }}
            restore-keys: |
                           ${{ runner.os }}-gradle-caches-
            
        - name: Make Gradlew Executable
          run: cd android && chmod +x ./gradlew
        
        - name: Build Android ${{inputs.environment == 'release' && 'Release' || 'Debug'}}
          run: |
                cd android && ./gradlew bundle${{inputs.environment == 'release' && 'Release' || 'Debug'}} --no-daemon

        
        - name: Upload application
          uses: actions/upload-artifact@v2
          with:
            name: app
            path: ./android/app/build/outputs/apk/debug/app-debug.apk
          
                
          


